!function(){"use strict";const e={inputSelector:".modal__input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t={editProfileButton:document.querySelector(".profile__edit-button"),editAvatarButton:document.querySelector(".profile__avatar-edit-button"),addCardButton:document.querySelector(".profile__add-button")};var s=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(e,t){let s=!1;e.forEach((e=>{e.validity.valid||(s=!0)})),s?(t.classList.add(this._inactiveButtonClass),t.disabled=!0):(t.classList.remove(this._inactiveButtonClass),t.disabled=!1)}_setEventListeners(){this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState(this._inputElements,this._submitButton)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputElements.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(this._inputElements,this._submitButton)}},r=class{constructor(e,t,s,r,i,n){let{name:a,link:o,_id:l,isLiked:d}=e;this._name=a,this._link=o,this._id=l,this._isLiked=d,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteCard=r,this._handleLike=i,this._handleDislike=n}getId(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._likeButton.classList.contains("card__like-button_active")?this._handleDislike(this._id):this._handleLike(this._id)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this._id)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}updateLikeButton(e){this._isLiked=e,this._likeButton.classList.toggle("card__like-button_active",this._isLiked)}getView(){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._cardImage=this._element.querySelector(".card__image"),this._cardTitle=this._element.querySelector(".card__title"),this._element.setAttribute("data-id",this._id),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardTitle.textContent=this._name,this.updateLikeButton(this._isLiked),this._setEventListeners(),this._element}};class i{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&(e.preventDefault(),this.close())}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-button"))&&this.close()}))}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}}class n extends i{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._inputElements=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__save"),this._submitButtonContent=this._submitButton.textContent}getForm(){return this._popupForm}_getInputValues(){return this._inputValues={},this._inputElements.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setInputValues(e){this._inputElements.forEach((t=>{e[t.name]&&(t.value=e[t.name])}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._inputValues=this._getInputValues(),this._handleFormSubmit(this._inputValues),this.close()}))}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";e?(this._submitButton.textContent=t,this._submitButton.disabled=!0):(this._submitButton.textContent=this._submitButtonContent,this._submitButton.disabled=!1)}close(){super.close()}resetForm(){this._popupForm.reset()}}const a=new n({popupSelector:"#edit-profile-modal",handleFormSubmit:e=>{a.setLoading(!0,"Saving..."),u.updateUserProfile(e.userName,e.userDescription).then((e=>{_.setUserInfo({userName:e.name,userDescription:e.about}),a.close()})).catch((e=>console.error("Error updating user profile:",e))).finally((()=>{a.setLoading(!1)}))}}),o=new n({popupSelector:"#update-avatar-modal",handleFormSubmit:e=>{const t=e.link;o.setLoading(!0,"Saving..."),u.updateUserAvatar(t).then((e=>{document.querySelector(".profile__avatar").src=e.avatar,o.close()})).catch((e=>console.error("Error updating profile picture:",e))).finally((()=>{o.setLoading(!1)}))}}),l=new n({popupSelector:"#add-card-modal",handleFormSubmit:e=>{l.setLoading(!0,"Saving..."),u.addNewCard(e).then((e=>{const t=c(e);m.addItem(t,!0),l.close(),l.resetForm()})).catch((e=>console.error("Error adding new card:",e))).finally((()=>{l.setLoading(!1)}))}}),d=new class extends i{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__preview-image"),this._caption=this._popupElement.querySelector(".modal__preview-caption")}open(e){let{link:t,name:s}=e;this._caption.textContent=s,this._image.src=t,this._image.alt=s,super.open()}}("#preview-image-modal"),h=new class extends i{constructor(e,t){super(e),this._handleConfirm=t,this._confirmButton=this._popupElement.querySelector(".modal__save"),this._closeButton=this._popupElement.querySelector(".modal__close-button")}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this._handleConfirm(),this.close()}))}open(e){super.open(),this._handleConfirm=e}}("#delete-card-modal");function c(e){const t=new r(e,"#card-template",(e=>{d.open({link:e.link,name:e.name})}),(e=>{h.open((()=>{u.deleteCard(e).then((()=>{document.querySelector(`.card[data-id="${e}"]`).remove()})).catch((e=>console.error("Error deleting card:",e)))}))}),(e=>{u.likeCard(e).then((e=>{t.updateLikeButton(e.isLiked)})).catch((e=>console.error("Error liking card:",e)))}),(e=>{u.dislikeCard(e).then((e=>{t.updateLikeButton(e.isLiked)})).catch((e=>console.error("Error disliking card:",e)))}));return t.getView()}const u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_handleError(e){return console.error(e),Promise.reject(e)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse).catch(this._handleError)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse).catch(this._handleError)}updateUserProfile(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this._handleResponse).catch(this._handleError)}updateUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._handleResponse).catch(this._handleError)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:s})}).then(this._handleResponse).catch(this._handleError)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponse).catch(this._handleError)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponse).catch(this._handleError)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse).catch(this._handleError)}loadUserInfoAndCards(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"3fd446db-e54d-438e-b742-4b3d652cdb08","Content-Type":"application/json"}}),_=new class{constructor(e){let{userNameSelector:t,userDescriptionSelector:s,userAvatarSelector:r}=e;this._userNameElement=document.querySelector(t),this._userDescriptionElement=document.querySelector(s),this._userAvatarElement=document.querySelector(r)}getUserInfo(){return{userName:this._userNameElement.textContent,userDescription:this._userDescriptionElement.textContent,avatar:this._userAvatarElement.src}}setUserInfo(e){let{userName:t,userDescription:s,avatar:r}=e;this._userNameElement.textContent=t,this._userDescriptionElement.textContent=s,r&&(this._userAvatarElement.src=r),this._userAvatarElement.onload=()=>{this._userAvatarElement.classList.add("loaded")}}}({userNameSelector:".profile__title",userDescriptionSelector:".profile__description",userAvatarSelector:".profile__avatar"});u.getUserInfo().then((e=>{_.setUserInfo({userName:e.name,userDescription:e.about,avatar:e.avatar})})).catch((e=>console.error("Error fetching user info:",e)));const m=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}addItem(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this._container.prepend(e):this._container.append(e)}renderItems(e){e.forEach(this._renderer)}}({items:[],renderer:e=>{const t=c(e);m.addItem(t)}},".cards__list");u.getInitialCards().then((e=>{m.renderItems(e)})).catch((e=>console.error("Error fetching cards:",e)));const p=new s(e,a.getForm()),E=new s(e,l.getForm()),v=new s(e,o.getForm());p.enableValidation(),E.enableValidation(),v.enableValidation(),t.editProfileButton.addEventListener("click",(()=>{const{userName:e,userDescription:t}=_.getUserInfo();a.setInputValues({userName:e,userDescription:t}),p.resetValidation(),a.open()})),t.addCardButton.addEventListener("click",(()=>{E.resetValidation(),l.open()})),t.editAvatarButton.addEventListener("click",(()=>{v.resetValidation(),o.open()})),d.setEventListeners(),a.setEventListeners(),o.setEventListeners(),l.setEventListeners(),h.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sTUFBTUEsRUFBb0IsQ0FDL0JDLGNBQWUsZ0JBQ2ZDLHFCQUFzQixlQUN0QkMsb0JBQXFCLHVCQUNyQkMsZ0JBQWlCLDBCQUNqQkMsV0FBWSx3QkFHREMsRUFBVSxDQUNyQkMsa0JBQW1CQyxTQUFTQyxjQUFjLHlCQUMxQ0MsaUJBQWtCRixTQUFTQyxjQUFjLGdDQUN6Q0UsY0FBZUgsU0FBU0MsY0FBYyx5QkNxRXhDLE1BaEZBLE1BQ0VHLFdBQUFBLENBQVlDLEVBQVNDLEdBQ25CQyxLQUFLQyxlQUFpQkgsRUFBUVosY0FDOUJjLEtBQUtFLHNCQUF3QkosRUFBUVgscUJBQ3JDYSxLQUFLRyxxQkFBdUJMLEVBQVFWLG9CQUNwQ1ksS0FBS0ksaUJBQW1CTixFQUFRVCxnQkFDaENXLEtBQUtLLFlBQWNQLEVBQVFSLFdBQzNCVSxLQUFLTSxNQUFRUCxDQUNmLENBRUFRLGVBQUFBLENBQWdCQyxHQUNkLE1BQU1DLEVBQXNCVCxLQUFLTSxNQUFNWixjQUNyQyxJQUFJYyxFQUFhRSxZQUVuQkYsRUFBYUcsVUFBVUMsSUFBSVosS0FBS0ksa0JBQ2hDSyxFQUFvQkksWUFBY0wsRUFBYU0sa0JBQy9DTCxFQUFvQkUsVUFBVUMsSUFBSVosS0FBS0ssWUFDekMsQ0FFQVUsZUFBQUEsQ0FBZ0JQLEdBQ2QsTUFBTUMsRUFBc0JULEtBQUtNLE1BQU1aLGNBQ3JDLElBQUljLEVBQWFFLFlBRW5CRixFQUFhRyxVQUFVSyxPQUFPaEIsS0FBS0ksa0JBQ25DSyxFQUFvQkksWUFBYyxHQUNsQ0osRUFBb0JFLFVBQVVLLE9BQU9oQixLQUFLSyxZQUM1QyxDQUVBWSxtQkFBQUEsQ0FBb0JULEdBQ2JBLEVBQWFVLFNBQVNDLE1BR3pCbkIsS0FBS2UsZ0JBQWdCUCxHQUZyQlIsS0FBS08sZ0JBQWdCQyxFQUl6QixDQUVBWSxrQkFBQUEsQ0FBbUJDLEVBQWVDLEdBQ2hDLElBQUlDLEdBQWUsRUFDbkJGLEVBQWNHLFNBQVNoQixJQUNoQkEsRUFBYVUsU0FBU0MsUUFDekJJLEdBQWUsRUFDakIsSUFFRUEsR0FDRkQsRUFBYVgsVUFBVUMsSUFBSVosS0FBS0csc0JBQ2hDbUIsRUFBYUcsVUFBVyxJQUV4QkgsRUFBYVgsVUFBVUssT0FBT2hCLEtBQUtHLHNCQUNuQ21CLEVBQWFHLFVBQVcsRUFFNUIsQ0FFQUMsa0JBQUFBLEdBQ0UxQixLQUFLMkIsZUFBaUJDLE1BQU1DLEtBQzFCN0IsS0FBS00sTUFBTXdCLGlCQUFpQjlCLEtBQUtDLGlCQUVuQ0QsS0FBSytCLGNBQWdCL0IsS0FBS00sTUFBTVosY0FBY00sS0FBS0UsdUJBQ25ERixLQUFLMkIsZUFBZUgsU0FBU2hCLElBQzNCQSxFQUFhd0IsaUJBQWlCLFNBQVVDLElBQ3RDakMsS0FBS2lCLG9CQUFvQlQsR0FDekJSLEtBQUtvQixtQkFBbUJwQixLQUFLMkIsZUFBZ0IzQixLQUFLK0IsY0FBYyxHQUNoRSxHQUVOLENBRUFHLGdCQUFBQSxHQUNFbEMsS0FBS00sTUFBTTBCLGlCQUFpQixVQUFXQyxJQUNyQ0EsRUFBSUUsZ0JBQWdCLElBRXRCbkMsS0FBSzBCLG9CQUNQLENBRUFVLGVBQUFBLEdBQ0VwQyxLQUFLMkIsZUFBZUgsU0FBU2hCLElBQzNCUixLQUFLZSxnQkFBZ0JQLEVBQWEsSUFFcENSLEtBQUtvQixtQkFBbUJwQixLQUFLMkIsZUFBZ0IzQixLQUFLK0IsY0FDcEQsR0NJRixFQWpGQSxNQUNFbEMsV0FBQUEsQ0FBV3dDLEVBRVRDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBQ0EsSUFOQSxLQUFFQyxFQUFJLEtBQUVDLEVBQUksSUFBRUMsRUFBRyxRQUFFQyxHQUFTVCxFQU81QnJDLEtBQUsrQyxNQUFRSixFQUNiM0MsS0FBS2dELE1BQVFKLEVBQ2I1QyxLQUFLNkMsSUFBTUEsRUFDWDdDLEtBQUtpRCxTQUFXSCxFQUNoQjlDLEtBQUtrRCxjQUFnQlosRUFDckJ0QyxLQUFLbUQsa0JBQW9CWixFQUN6QnZDLEtBQUtvRCxrQkFBb0JaLEVBQ3pCeEMsS0FBS3FELFlBQWNaLEVBQ25CekMsS0FBS3NELGVBQWlCWixDQUN4QixDQUVBYSxLQUFBQSxHQUNFLE9BQU92RCxLQUFLNkMsR0FDZCxDQUVBVyxZQUFBQSxHQUNFLE9BQU8vRCxTQUNKQyxjQUFjTSxLQUFLa0QsZUFDbkJPLFFBQVEvRCxjQUFjLFNBQ3RCZ0UsV0FBVSxFQUNmLENBRUFoQyxrQkFBQUEsR0FDRTFCLEtBQUsyRCxZQUFZM0IsaUJBQWlCLFNBQVMsS0FDeEJoQyxLQUFLMkQsWUFBWWhELFVBQVVpRCxTQUMxQyw0QkFFUzVELEtBQUtzRCxlQUFldEQsS0FBSzZDLEtBQU83QyxLQUFLcUQsWUFBWXJELEtBQUs2QyxJQUFJLElBR3ZFN0MsS0FBSzZELGNBQWM3QixpQkFBaUIsU0FBUyxLQUMzQ2hDLEtBQUtvRCxrQkFBa0JwRCxLQUFLNkMsSUFBSSxJQUdsQzdDLEtBQUs4RCxXQUFXOUIsaUJBQWlCLFNBQVMsS0FDeENoQyxLQUFLbUQsa0JBQWtCLENBQ3JCUixLQUFNM0MsS0FBSytDLE1BQ1hILEtBQU01QyxLQUFLZ0QsT0FDWCxHQUVOLENBRUFlLGdCQUFBQSxDQUFpQmpCLEdBQ2Y5QyxLQUFLaUQsU0FBV0gsRUFDaEI5QyxLQUFLMkQsWUFBWWhELFVBQVVxRCxPQUN6QiwyQkFDQWhFLEtBQUtpRCxTQUVULENBRUFnQixPQUFBQSxHQWtCRSxPQWpCQWpFLEtBQUtrRSxTQUFXbEUsS0FBS3dELGVBRXJCeEQsS0FBSzJELFlBQWMzRCxLQUFLa0UsU0FBU3hFLGNBQWMsc0JBQy9DTSxLQUFLNkQsY0FBZ0I3RCxLQUFLa0UsU0FBU3hFLGNBQWMsd0JBQ2pETSxLQUFLOEQsV0FBYTlELEtBQUtrRSxTQUFTeEUsY0FBYyxnQkFDOUNNLEtBQUttRSxXQUFhbkUsS0FBS2tFLFNBQVN4RSxjQUFjLGdCQUU5Q00sS0FBS2tFLFNBQVNFLGFBQWEsVUFBV3BFLEtBQUs2QyxLQUUzQzdDLEtBQUs4RCxXQUFXTyxJQUFNckUsS0FBS2dELE1BQzNCaEQsS0FBSzhELFdBQVdRLElBQU10RSxLQUFLK0MsTUFDM0IvQyxLQUFLbUUsV0FBV3RELFlBQWNiLEtBQUsrQyxNQUVuQy9DLEtBQUsrRCxpQkFBaUIvRCxLQUFLaUQsVUFFM0JqRCxLQUFLMEIscUJBRUUxQixLQUFLa0UsUUFDZCxHQzlFYSxNQUFNSyxFQUNuQjFFLFdBQUFBLENBQVkyRSxHQUNWeEUsS0FBS3lFLGNBQWdCaEYsU0FBU0MsY0FBYzhFLEdBQzVDeEUsS0FBSzBFLGdCQUFrQjFFLEtBQUswRSxnQkFBZ0JDLEtBQUszRSxLQUNuRCxDQUVBMEUsZUFBQUEsQ0FBZ0J6QyxHQUNFLFdBQVpBLEVBQUkyQyxNQUNOM0MsRUFBSUUsaUJBQ0puQyxLQUFLNkUsUUFFVCxDQUVBQyxpQkFBQUEsR0FDRTlFLEtBQUt5RSxjQUFjekMsaUJBQWlCLFNBQVVDLEtBRTFDQSxFQUFJOEMsT0FBT3BFLFVBQVVpRCxTQUFTLFVBQzlCM0IsRUFBSThDLE9BQU9wRSxVQUFVaUQsU0FBUyx5QkFFOUI1RCxLQUFLNkUsT0FDUCxHQUVKLENBRUFHLElBQUFBLEdBQ0VoRixLQUFLeUUsY0FBYzlELFVBQVVDLElBQUksZ0JBQ2pDbkIsU0FBU3VDLGlCQUFpQixVQUFXaEMsS0FBSzBFLGdCQUM1QyxDQUVBRyxLQUFBQSxHQUNFN0UsS0FBS3lFLGNBQWM5RCxVQUFVSyxPQUFPLGdCQUNwQ3ZCLFNBQVN3RixvQkFBb0IsVUFBV2pGLEtBQUswRSxnQkFDL0MsRUM5QmEsTUFBTVEsVUFBc0JYLEVBQ3pDMUUsV0FBQUEsQ0FBV3dDLEdBQXNDLElBQXJDLGNBQUVtQyxFQUFhLGlCQUFFVyxHQUFrQjlDLEVBQzdDK0MsTUFBTVosR0FDTnhFLEtBQUtxRixXQUFhckYsS0FBS3lFLGNBQWMvRSxjQUFjLGdCQUNuRE0sS0FBS3NGLGtCQUFvQkgsRUFDekJuRixLQUFLMkIsZUFBaUIzQixLQUFLeUUsY0FBYzNDLGlCQUFpQixpQkFDMUQ5QixLQUFLK0IsY0FBZ0IvQixLQUFLeUUsY0FBYy9FLGNBQWMsZ0JBQ3RETSxLQUFLdUYscUJBQXVCdkYsS0FBSytCLGNBQWNsQixXQUNqRCxDQUVBMkUsT0FBQUEsR0FDRSxPQUFPeEYsS0FBS3FGLFVBQ2QsQ0FFQUksZUFBQUEsR0FNRSxPQUxBekYsS0FBSzBGLGFBQWUsQ0FBQyxFQUNyQjFGLEtBQUsyQixlQUFlSCxTQUFTbUUsSUFDM0IzRixLQUFLMEYsYUFBYUMsRUFBTWhELE1BQVFnRCxFQUFNQyxLQUFLLElBR3RDNUYsS0FBSzBGLFlBQ2QsQ0FFQUcsY0FBQUEsQ0FBZUMsR0FDYjlGLEtBQUsyQixlQUFlSCxTQUFTbUUsSUFDdkJHLEVBQUtILEVBQU1oRCxRQUNiZ0QsRUFBTUMsTUFBUUUsRUFBS0gsRUFBTWhELE1BQzNCLEdBRUosQ0FFQW1DLGlCQUFBQSxHQUNFTSxNQUFNTixvQkFFTjlFLEtBQUtxRixXQUFXckQsaUJBQWlCLFVBQVdDLElBQzFDQSxFQUFJRSxpQkFDSm5DLEtBQUswRixhQUFlMUYsS0FBS3lGLGtCQUN6QnpGLEtBQUtzRixrQkFBa0J0RixLQUFLMEYsY0FDNUIxRixLQUFLNkUsT0FBTyxHQUVoQixDQUVBa0IsVUFBQUEsQ0FBV0MsR0FBc0MsSUFBM0JDLEVBQVdDLFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUcsWUFDOUJGLEdBQ0ZoRyxLQUFLK0IsY0FBY2xCLFlBQWNvRixFQUNqQ2pHLEtBQUsrQixjQUFjTixVQUFXLElBRTlCekIsS0FBSytCLGNBQWNsQixZQUFjYixLQUFLdUYscUJBQ3RDdkYsS0FBSytCLGNBQWNOLFVBQVcsRUFFbEMsQ0FFQW9ELEtBQUFBLEdBQ0VPLE1BQU1QLE9BQ1IsQ0FFQXdCLFNBQUFBLEdBQ0VyRyxLQUFLcUYsV0FBV2lCLE9BQ2xCLEVDOUNGLE1BQU1DLEVBQW1CLElBQUlyQixFQUFjLENBQ3pDVixjQUFlLHNCQUNmVyxpQkFBbUJXLElBQ2pCUyxFQUFpQlIsWUFBVyxFQUFNLGFBRWxDUyxFQUNHQyxrQkFBa0JYLEVBQUtZLFNBQVVaLEVBQUthLGlCQUN0Q0MsTUFBTUMsSUFDTEMsRUFBU0MsWUFBWSxDQUNuQkwsU0FBVUcsRUFBWWxFLEtBQ3RCZ0UsZ0JBQWlCRSxFQUFZRyxRQUUvQlQsRUFBaUIxQixPQUFPLElBRXpCb0MsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTSwrQkFBZ0NGLEtBQzdERyxTQUFRLEtBQ1BkLEVBQWlCUixZQUFXLEVBQU0sR0FDbEMsSUFJRnVCLEVBQW9CLElBQUlwQyxFQUFjLENBQzFDVixjQUFlLHVCQUNmVyxpQkFBbUJXLElBQ2pCLE1BQU15QixFQUFhekIsRUFBS2xELEtBQ3hCMEUsRUFBa0J2QixZQUFXLEVBQU0sYUFFbkNTLEVBQ0dnQixpQkFBaUJELEdBQ2pCWCxNQUFNQyxJQUNpQnBILFNBQVNDLGNBQWMsb0JBQy9CMkUsSUFBTXdDLEVBQVlZLE9BQ2hDSCxFQUFrQnpDLE9BQU8sSUFFMUJvQyxPQUFPQyxHQUFRQyxRQUFRQyxNQUFNLGtDQUFtQ0YsS0FDaEVHLFNBQVEsS0FDUEMsRUFBa0J2QixZQUFXLEVBQU0sR0FDbkMsSUFJRjJCLEVBQWUsSUFBSXhDLEVBQWMsQ0FDckNWLGNBQWUsa0JBQ2ZXLGlCQUFtQndDLElBQ2pCRCxFQUFhM0IsWUFBVyxFQUFNLGFBRTlCUyxFQUNHb0IsV0FBV0QsR0FDWGYsTUFBTWlCLElBQ0wsTUFBTUMsRUFBaUJDLEVBQVdGLEdBQ2xDRyxFQUFTQyxRQUFRSCxHQUFnQixHQUNqQ0osRUFBYTdDLFFBQ2I2QyxFQUFhckIsV0FBVyxJQUV6QlksT0FBT0MsR0FBUUMsUUFBUUMsTUFBTSx5QkFBMEJGLEtBQ3ZERyxTQUFRLEtBQ1BLLEVBQWEzQixZQUFXLEVBQU0sR0FDOUIsSUFJRm1DLEVBQW9CLElDekVYLGNBQTZCM0QsRUFDMUMxRSxXQUFBQSxDQUFZMkUsR0FDVlksTUFBTVosR0FDTnhFLEtBQUttSSxPQUFTbkksS0FBS3lFLGNBQWMvRSxjQUFjLHlCQUMvQ00sS0FBS29JLFNBQVdwSSxLQUFLeUUsY0FBYy9FLGNBQWMsMEJBQ25ELENBRUFzRixJQUFBQSxDQUFJM0MsR0FBaUIsSUFBaEIsS0FBRU8sRUFBSSxLQUFFRCxHQUFNTixFQUNqQnJDLEtBQUtvSSxTQUFTdkgsWUFBYzhCLEVBQzVCM0MsS0FBS21JLE9BQU85RCxJQUFNekIsRUFDbEI1QyxLQUFLbUksT0FBTzdELElBQU0zQixFQUNsQnlDLE1BQU1KLE1BQ1IsR0Q2RDJDLHdCQUV2Q3FELEVBQWtCLElFM0VULGNBQW9DOUQsRUFDakQxRSxXQUFBQSxDQUFZMkUsRUFBZThELEdBQ3pCbEQsTUFBTVosR0FDTnhFLEtBQUt1SSxlQUFpQkQsRUFDdEJ0SSxLQUFLd0ksZUFBaUJ4SSxLQUFLeUUsY0FBYy9FLGNBQWMsZ0JBQ3ZETSxLQUFLeUksYUFBZXpJLEtBQUt5RSxjQUFjL0UsY0FDckMsdUJBRUosQ0FFQW9GLGlCQUFBQSxHQUNFTSxNQUFNTixvQkFFTjlFLEtBQUt3SSxlQUFleEcsaUJBQWlCLFNBQVMsS0FDNUNoQyxLQUFLdUksaUJBQ0x2SSxLQUFLNkUsT0FBTyxHQUVoQixDQUVBRyxJQUFBQSxDQUFLc0QsR0FDSGxELE1BQU1KLE9BQ05oRixLQUFLdUksZUFBaUJELENBQ3hCLEdGcURnRCxzQkFJbEQsU0FBU1AsRUFBV0osR0FDbEIsTUFBTWUsRUFBTyxJQUFJQyxFQUNmaEIsRUFDQSxrQkFDQ0EsSUFDQ08sRUFBa0JsRCxLQUFLLENBQUVwQyxLQUFNK0UsRUFBUy9FLEtBQU1ELEtBQU1nRixFQUFTaEYsTUFBTyxJQUVyRWlHLElBQ0NQLEVBQWdCckQsTUFBSyxLQUNuQndCLEVBQ0dxQyxXQUFXRCxHQUNYaEMsTUFBSyxLQUNnQm5ILFNBQVNDLGNBQzNCLGtCQUFrQmtKLE9BRVI1SCxRQUFRLElBRXJCaUcsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTSx1QkFBd0JGLElBQUssR0FDN0QsSUFFSDBCLElBQ0NwQyxFQUNHc0MsU0FBU0YsR0FDVGhDLE1BQU1tQyxJQUNMTCxFQUFLM0UsaUJBQWlCZ0YsRUFBZ0JqRyxRQUFRLElBRS9DbUUsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTSxxQkFBc0JGLElBQUssSUFFNUQwQixJQUNDcEMsRUFDR3dDLFlBQVlKLEdBQ1poQyxNQUFNbUMsSUFDTEwsRUFBSzNFLGlCQUFpQmdGLEVBQWdCakcsUUFBUSxJQUUvQ21FLE9BQU9DLEdBQVFDLFFBQVFDLE1BQU0sd0JBQXlCRixJQUFLLElBR2xFLE9BQU93QixFQUFLekUsU0FDZCxDQUlBLE1BQU11QyxFQUFNLElHM0hHLE1BQ2IzRyxXQUFBQSxDQUFXd0MsR0FBdUIsSUFBdEIsUUFBRTRHLEVBQU8sUUFBRUMsR0FBUzdHLEVBQzlCckMsS0FBS21KLFNBQVdGLEVBQ2hCakosS0FBS29KLFNBQVdGLENBQ2xCLENBRUFHLGVBQUFBLENBQWdCQyxHQUNkLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQU8sVUFBVUosRUFBSUssU0FDdEMsQ0FFQUMsWUFBQUEsQ0FBYTFDLEdBRVgsT0FEQUMsUUFBUUMsTUFBTUYsR0FDUHVDLFFBQVFDLE9BQU94QyxFQUN4QixDQUVBMkMsZUFBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUc5SixLQUFLbUosaUJBQWtCLENBQUVELFFBQVNsSixLQUFLb0osV0FDcER4QyxLQUFLNUcsS0FBS3FKLGlCQUNWcEMsTUFBTWpILEtBQUs0SixhQUNoQixDQUVBRyxXQUFBQSxHQUNFLE9BQU9ELE1BQU0sR0FBRzlKLEtBQUttSixvQkFBcUIsQ0FBRUQsUUFBU2xKLEtBQUtvSixXQUN2RHhDLEtBQUs1RyxLQUFLcUosaUJBQ1ZwQyxNQUFNakgsS0FBSzRKLGFBQ2hCLENBRUFuRCxpQkFBQUEsQ0FBa0JDLEVBQVVDLEdBQzFCLE9BQU9tRCxNQUFNLEdBQUc5SixLQUFLbUosb0JBQXFCLENBQ3hDYSxPQUFRLFFBQ1JkLFFBQVMsSUFDSmxKLEtBQUtvSixTQUNSLGVBQWdCLG9CQUVsQmEsS0FBTUMsS0FBS0MsVUFBVSxDQUFFeEgsS0FBTStELEVBQVVNLE1BQU9MLE1BRTdDQyxLQUFLNUcsS0FBS3FKLGlCQUNWcEMsTUFBTWpILEtBQUs0SixhQUNoQixDQUVBcEMsZ0JBQUFBLENBQWlCRCxHQUNmLE9BQU91QyxNQUFNLEdBQUc5SixLQUFLbUosMkJBQTRCLENBQy9DYSxPQUFRLFFBQ1JkLFFBQVMsSUFDSmxKLEtBQUtvSixTQUNSLGVBQWdCLG9CQUVsQmEsS0FBTUMsS0FBS0MsVUFBVSxDQUFFMUMsT0FBUUYsTUFFOUJYLEtBQUs1RyxLQUFLcUosaUJBQ1ZwQyxNQUFNakgsS0FBSzRKLGFBQ2hCLENBRUFoQyxVQUFBQSxDQUFVd0MsR0FBaUIsSUFBaEIsS0FBRXpILEVBQUksS0FBRUMsR0FBTXdILEVBQ3ZCLE9BQU9OLE1BQU0sR0FBRzlKLEtBQUttSixpQkFBa0IsQ0FDckNhLE9BQVEsT0FDUmQsUUFBUyxJQUNKbEosS0FBS29KLFNBQ1IsZUFBZ0Isb0JBRWxCYSxLQUFNQyxLQUFLQyxVQUFVLENBQUV4SCxPQUFNQyxXQUU1QmdFLEtBQUs1RyxLQUFLcUosaUJBQ1ZwQyxNQUFNakgsS0FBSzRKLGFBQ2hCLENBRUFkLFFBQUFBLENBQVNGLEdBQ1AsT0FBT2tCLE1BQU0sR0FBRzlKLEtBQUttSixrQkFBa0JQLFVBQWdCLENBQ3JEb0IsT0FBUSxNQUNSZCxRQUFTbEosS0FBS29KLFdBRWJ4QyxLQUFLNUcsS0FBS3FKLGlCQUNWcEMsTUFBTWpILEtBQUs0SixhQUNoQixDQUVBWixXQUFBQSxDQUFZSixHQUNWLE9BQU9rQixNQUFNLEdBQUc5SixLQUFLbUosa0JBQWtCUCxVQUFnQixDQUNyRG9CLE9BQVEsU0FDUmQsUUFBU2xKLEtBQUtvSixXQUVieEMsS0FBSzVHLEtBQUtxSixpQkFDVnBDLE1BQU1qSCxLQUFLNEosYUFDaEIsQ0FFQWYsVUFBQUEsQ0FBV0QsR0FDVCxPQUFPa0IsTUFBTSxHQUFHOUosS0FBS21KLGtCQUFrQlAsSUFBVSxDQUMvQ29CLE9BQVEsU0FDUmQsUUFBU2xKLEtBQUtvSixXQUVieEMsS0FBSzVHLEtBQUtxSixpQkFDVnBDLE1BQU1qSCxLQUFLNEosYUFDaEIsQ0FFQVMsb0JBQUFBLEdBQ0UsT0FBT1osUUFBUWEsSUFBSSxDQUFDdEssS0FBSytKLGNBQWUvSixLQUFLNkosbUJBQy9DLEdIeUJrQixDQUNsQlosUUFBUyxrREFDVEMsUUFBUyxDQUNQcUIsY0FBZSx1Q0FDZixlQUFnQixzQkFNZHpELEVBQVcsSUlySUYsTUFDYmpILFdBQUFBLENBQVd3QyxHQUlSLElBSlMsaUJBQ1ZtSSxFQUFnQix3QkFDaEJDLEVBQXVCLG1CQUN2QkMsR0FDRHJJLEVBQ0NyQyxLQUFLMkssaUJBQW1CbEwsU0FBU0MsY0FBYzhLLEdBQy9DeEssS0FBSzRLLHdCQUEwQm5MLFNBQVNDLGNBQ3RDK0ssR0FFRnpLLEtBQUs2SyxtQkFBcUJwTCxTQUFTQyxjQUFjZ0wsRUFDbkQsQ0FFQVgsV0FBQUEsR0FDRSxNQUFPLENBQ0xyRCxTQUFVMUcsS0FBSzJLLGlCQUFpQjlKLFlBQ2hDOEYsZ0JBQWlCM0csS0FBSzRLLHdCQUF3Qi9KLFlBQzlDNEcsT0FBUXpILEtBQUs2SyxtQkFBbUJ4RyxJQUVwQyxDQUVBMEMsV0FBQUEsQ0FBV3FELEdBQXdDLElBQXZDLFNBQUUxRCxFQUFRLGdCQUFFQyxFQUFlLE9BQUVjLEdBQVEyQyxFQUMvQ3BLLEtBQUsySyxpQkFBaUI5SixZQUFjNkYsRUFDcEMxRyxLQUFLNEssd0JBQXdCL0osWUFBYzhGLEVBQ3ZDYyxJQUNGekgsS0FBSzZLLG1CQUFtQnhHLElBQU1vRCxHQUVoQ3pILEtBQUs2SyxtQkFBbUJDLE9BQVMsS0FDL0I5SyxLQUFLNkssbUJBQW1CbEssVUFBVUMsSUFBSSxTQUFTLENBRW5ELEdKdUc0QixDQUM1QjRKLGlCQUFrQixrQkFDbEJDLHdCQUF5Qix3QkFDekJDLG1CQUFvQixxQkFHdEJsRSxFQUNHdUQsY0FDQW5ELE1BQU1tRSxJQUNMakUsRUFBU0MsWUFBWSxDQUNuQkwsU0FBVXFFLEVBQVNwSSxLQUNuQmdFLGdCQUFpQm9FLEVBQVMvRCxNQUMxQlMsT0FBUXNELEVBQVN0RCxRQUNqQixJQUVIUixPQUFPQyxHQUFRQyxRQUFRQyxNQUFNLDRCQUE2QkYsS0FJN0QsTUFBTWMsRUFBVyxJS3hKRixNQUNibkksV0FBQUEsQ0FBV3dDLEVBQXNCMkksR0FBbUIsSUFBeEMsTUFBRUMsRUFBSyxTQUFFQyxHQUFVN0ksRUFDN0JyQyxLQUFLbUwsT0FBU0YsRUFDZGpMLEtBQUtvTCxVQUFZRixFQUNqQmxMLEtBQUtxTCxXQUFhNUwsU0FBU0MsY0FBY3NMLEVBQzNDLENBRUEvQyxPQUFBQSxDQUFRcUQsR0FBYXBGLFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxJQUFBQSxVQUFBLEdBRWpCbEcsS0FBS3FMLFdBQVdFLFFBQVFELEdBRXhCdEwsS0FBS3FMLFdBQVdHLE9BQU9GLEVBRTNCLENBRUFHLFdBQUFBLENBQVlSLEdBQ1ZBLEVBQU16SixRQUFReEIsS0FBS29MLFVBQ3JCLEdMd0lBLENBQ0VILE1BQU8sR0FDUEMsU0FBV3ZELElBQ1QsTUFBTStELEVBQWMzRCxFQUFXSixHQUMvQkssRUFBU0MsUUFBUXlELEVBQVksR0FHakMsZ0JBS0ZsRixFQUNHcUQsa0JBQ0FqRCxNQUFNK0UsSUFDTDNELEVBQVN5RCxZQUFZRSxFQUFNLElBRTVCMUUsT0FBT0MsR0FBUUMsUUFBUUMsTUFBTSx3QkFBeUJGLEtBSXpELE1BQU0wRSxFQUFvQixJQUFJQyxFQUM1QjVNLEVBQ0FzSCxFQUFpQmYsV0FFYnNHLEVBQW1CLElBQUlELEVBQzNCNU0sRUFDQXlJLEVBQWFsQyxXQUdUdUcsRUFBMEIsSUFBSUYsRUFDbEM1TSxFQUNBcUksRUFBa0I5QixXQUdwQm9HLEVBQWtCMUosbUJBQ2xCNEosRUFBaUI1SixtQkFDakI2SixFQUF3QjdKLG1CQUl4QjNDLEVBQVFDLGtCQUFrQndDLGlCQUFpQixTQUFTLEtBQ2xELE1BQU0sU0FBRTBFLEVBQVEsZ0JBQUVDLEdBQW9CRyxFQUFTaUQsY0FDL0N4RCxFQUFpQlYsZUFBZSxDQUFFYSxXQUFVQyxvQkFDNUNpRixFQUFrQnhKLGtCQUNsQm1FLEVBQWlCdkIsTUFBTSxJQUd6QnpGLEVBQVFLLGNBQWNvQyxpQkFBaUIsU0FBUyxLQUM5QzhKLEVBQWlCMUosa0JBQ2pCc0YsRUFBYTFDLE1BQU0sSUFHckJ6RixFQUFRSSxpQkFBaUJxQyxpQkFBaUIsU0FBUyxLQUNqRCtKLEVBQXdCM0osa0JBQ3hCa0YsRUFBa0J0QyxNQUFNLElBSzFCa0QsRUFBa0JwRCxvQkFDbEJ5QixFQUFpQnpCLG9CQUNqQndDLEVBQWtCeEMsb0JBQ2xCNEMsRUFBYTVDLG9CQUNidUQsRUFBZ0J2RCxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uT3B0aW9ucyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZVwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5leHBvcnQgY29uc3QgYnV0dG9ucyA9IHtcbiAgZWRpdFByb2ZpbGVCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIiksXG4gIGVkaXRBdmF0YXJCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCIpLFxuICBhZGRDYXJkQnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIiksXG59O1xuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IG9wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IG9wdGlvbnMuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gb3B0aW9ucy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRFbGVtZW50cywgc3VibWl0QnV0dG9uKSB7XG4gICAgbGV0IGZvdW5kSW52YWxpZCA9IGZhbHNlO1xuICAgIGlucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICBmb3VuZEludmFsaWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChmb3VuZEludmFsaWQpIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRFbGVtZW50cywgdGhpcy5fc3VibWl0QnV0dG9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVsZW1lbnRzLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBfaWQsIGlzTGlrZWQgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxuICAgIGhhbmRsZUxpa2UsXG4gICAgaGFuZGxlRGlzbGlrZVxuICApIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9pZCA9IF9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gICAgdGhpcy5faGFuZGxlTGlrZSA9IGhhbmRsZUxpa2U7XG4gICAgdGhpcy5faGFuZGxlRGlzbGlrZSA9IGhhbmRsZURpc2xpa2U7XG4gIH1cblxuICBnZXRJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgY29uc3QgaXNBY3RpdmUgPSB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcbiAgICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIlxuICAgICAgKTtcbiAgICAgIGlzQWN0aXZlID8gdGhpcy5faGFuZGxlRGlzbGlrZSh0aGlzLl9pZCkgOiB0aGlzLl9oYW5kbGVMaWtlKHRoaXMuX2lkKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe1xuICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVMaWtlQnV0dG9uKGlzTGlrZWQpIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXG4gICAgICBcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiLFxuICAgICAgdGhpcy5faXNMaWtlZFxuICAgICk7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuXG4gICAgdGhpcy5fZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIHRoaXMuX2lkKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLnVwZGF0ZUxpa2VCdXR0b24odGhpcy5faXNMaWtlZCk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25Db250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgZ2V0Rm9ybSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcG9wdXBGb3JtO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5faW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpZiAoZGF0YVtpbnB1dC5uYW1lXSkge1xuICAgICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9pbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2lucHV0VmFsdWVzKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbkNvbnRlbnQ7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgcmVzZXRGb3JtKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJpbXBvcnQgeyB2YWxpZGF0aW9uT3B0aW9ucywgYnV0dG9ucyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuLy8gUG9wdXBzXG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xuICAgIGVkaXRQcm9maWxlUG9wdXAuc2V0TG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcblxuICAgIGFwaVxuICAgICAgLnVwZGF0ZVVzZXJQcm9maWxlKGRhdGEudXNlck5hbWUsIGRhdGEudXNlckRlc2NyaXB0aW9uKVxuICAgICAgLnRoZW4oKHVwZGF0ZWREYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgICB1c2VyTmFtZTogdXBkYXRlZERhdGEubmFtZSxcbiAgICAgICAgICB1c2VyRGVzY3JpcHRpb246IHVwZGF0ZWREYXRhLmFib3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgdXNlciBwcm9maWxlOlwiLCBlcnIpKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBlZGl0UHJvZmlsZVBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG4gIH0sXG59KTtcblxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI3VwZGF0ZS1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBjb25zdCBhdmF0YXJMaW5rID0gZGF0YS5saW5rO1xuICAgIHVwZGF0ZUF2YXRhclBvcHVwLnNldExvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XG5cbiAgICBhcGlcbiAgICAgIC51cGRhdGVVc2VyQXZhdGFyKGF2YXRhckxpbmspXG4gICAgICAudGhlbigodXBkYXRlZERhdGEpID0+IHtcbiAgICAgICAgY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuICAgICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVwZGF0ZWREYXRhLmF2YXRhcjtcbiAgICAgICAgdXBkYXRlQXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGUgcGljdHVyZTpcIiwgZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgdXBkYXRlQXZhdGFyUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgfSxcbn0pO1xuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChjYXJkRGF0YSkgPT4ge1xuICAgIGFkZENhcmRQb3B1cC5zZXRMb2FkaW5nKHRydWUsIFwiU2F2aW5nLi4uXCIpO1xuXG4gICAgYXBpXG4gICAgICAuYWRkTmV3Q2FyZChjYXJkRGF0YSlcbiAgICAgIC50aGVuKChuZXdDYXJkRGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBuZXdDYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQobmV3Q2FyZERhdGEpO1xuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKG5ld0NhcmRFbGVtZW50LCB0cnVlKTtcbiAgICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICAgIGFkZENhcmRQb3B1cC5yZXNldEZvcm0oKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBuZXcgY2FyZDpcIiwgZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgYWRkQ2FyZFBvcHVwLnNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG4gIH0sXG59KTtcblxuY29uc3QgcHJldmlld0ltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcblxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcblxuLy8gQ2FyZCBpbnN0YW5jZVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgKGNhcmREYXRhKSA9PiB7XG4gICAgICBwcmV2aWV3SW1hZ2VQb3B1cC5vcGVuKHsgbGluazogY2FyZERhdGEubGluaywgbmFtZTogY2FyZERhdGEubmFtZSB9KTtcbiAgICB9LFxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCgpID0+IHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgYC5jYXJkW2RhdGEtaWQ9XCIke2NhcmRJZH1cIl1gXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhcmQ6XCIsIGVycikpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICAoY2FyZElkKSA9PiB7XG4gICAgICBhcGlcbiAgICAgICAgLmxpa2VDYXJkKGNhcmRJZClcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkRGF0YSkgPT4ge1xuICAgICAgICAgIGNhcmQudXBkYXRlTGlrZUJ1dHRvbih1cGRhdGVkQ2FyZERhdGEuaXNMaWtlZCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgbGlraW5nIGNhcmQ6XCIsIGVycikpO1xuICAgIH0sXG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgYXBpXG4gICAgICAgIC5kaXNsaWtlQ2FyZChjYXJkSWQpXG4gICAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZERhdGEpID0+IHtcbiAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VCdXR0b24odXBkYXRlZENhcmREYXRhLmlzTGlrZWQpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGRpc2xpa2luZyBjYXJkOlwiLCBlcnIpKTtcbiAgICB9XG4gICk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cblxuLy8gQXBpIGluc3RhbmNlXG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjNmZDQ0NmRiLWU1NGQtNDM4ZS1iNzQyLTRiM2Q2NTJjZGIwOFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIFVzZXIgSW5mb1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHVzZXJOYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICB1c2VyQXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxufSk7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICB1c2VyTmFtZTogdXNlckRhdGEubmFtZSxcbiAgICAgIHVzZXJEZXNjcmlwdGlvbjogdXNlckRhdGEuYWJvdXQsXG4gICAgICBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhcixcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycikpO1xuXG4vLyBDYXJkIExpc3RcblxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBbXSxcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIlxuKTtcblxuLy8gRmV0Y2ggY2FyZHMgZnJvbSBBUElcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigoY2FyZHMpID0+IHtcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhjYXJkcyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgY2FyZHM6XCIsIGVycikpO1xuXG4vLyBWYWxpZGF0aW9uXG5cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25PcHRpb25zLFxuICBlZGl0UHJvZmlsZVBvcHVwLmdldEZvcm0oKVxuKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvbk9wdGlvbnMsXG4gIGFkZENhcmRQb3B1cC5nZXRGb3JtKClcbik7XG5cbmNvbnN0IGVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25PcHRpb25zLFxuICB1cGRhdGVBdmF0YXJQb3B1cC5nZXRGb3JtKClcbik7XG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBFdmVudCBsaXN0ZW5lcnNcblxuYnV0dG9ucy5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IHVzZXJOYW1lLCB1c2VyRGVzY3JpcHRpb24gfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGVkaXRQcm9maWxlUG9wdXAuc2V0SW5wdXRWYWx1ZXMoeyB1c2VyTmFtZSwgdXNlckRlc2NyaXB0aW9uIH0pO1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuYnV0dG9ucy5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuYnV0dG9ucy5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICB1cGRhdGVBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gU2V0IGV2ZW50IGxpc3RlbmVycyBmb3IgcG9wdXBzXG5cbnByZXZpZXdJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG51cGRhdGVBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWNhcHRpb25cIik7XG4gIH1cblxuICBvcGVuKHsgbGluaywgbmFtZSB9KSB7XG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlQ29uZmlybSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0gPSBoYW5kbGVDb25maXJtO1xuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZVwiKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4gICAgKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDb25maXJtKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cblxuICBvcGVuKGhhbmRsZUNvbmZpcm0pIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5faGFuZGxlQ29uZmlybSA9IGhhbmRsZUNvbmZpcm07XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfaGFuZGxlUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIF9oYW5kbGVFcnJvcihlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pXG4gICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAgIC5jYXRjaCh0aGlzLl9oYW5kbGVFcnJvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSlcbiAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxuICAgICAgLmNhdGNoKHRoaXMuX2hhbmRsZUVycm9yKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJQcm9maWxlKHVzZXJOYW1lLCB1c2VyRGVzY3JpcHRpb24pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLi4udGhpcy5faGVhZGVycyxcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lOiB1c2VyTmFtZSwgYWJvdXQ6IHVzZXJEZXNjcmlwdGlvbiB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xuICB9XG5cbiAgdXBkYXRlVXNlckF2YXRhcihhdmF0YXJMaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAuLi50aGlzLl9oZWFkZXJzLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyTGluayB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xuICB9XG5cbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIC4uLnRoaXMuX2hlYWRlcnMsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXG4gICAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxuICAgICAgLmNhdGNoKHRoaXMuX2hhbmRsZUVycm9yKTtcbiAgfVxuXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAgIC5jYXRjaCh0aGlzLl9oYW5kbGVFcnJvcik7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAgIC5jYXRjaCh0aGlzLl9oYW5kbGVFcnJvcik7XG4gIH1cblxuICBsb2FkVXNlckluZm9BbmRDYXJkcygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICB1c2VyTmFtZVNlbGVjdG9yLFxuICAgIHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yLFxuICAgIHVzZXJBdmF0YXJTZWxlY3RvcixcbiAgfSkge1xuICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB1c2VyRGVzY3JpcHRpb25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5fdXNlckF2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlck5hbWU6IHRoaXMuX3VzZXJOYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIHVzZXJEZXNjcmlwdGlvbjogdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fdXNlckF2YXRhckVsZW1lbnQuc3JjLFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IHVzZXJOYW1lLCB1c2VyRGVzY3JpcHRpb24sIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlck5hbWU7XG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IHVzZXJEZXNjcmlwdGlvbjtcbiAgICBpZiAoYXZhdGFyKSB7XG4gICAgICB0aGlzLl91c2VyQXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gICAgfVxuICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50Lm9ubG9hZCA9ICgpID0+IHtcbiAgICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJsb2FkZWRcIik7XG4gICAgfTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtLCBwcmVwZW5kID0gZmFsc2UpIHtcbiAgICBpZiAocHJlcGVuZCkge1xuICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInZhbGlkYXRpb25PcHRpb25zIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJidXR0b25zIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJlZGl0QXZhdGFyQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0RWxlbWVudHMiLCJzdWJtaXRCdXR0b24iLCJmb3VuZEludmFsaWQiLCJmb3JFYWNoIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfaW5wdXRFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2UiLCJoYW5kbGVEaXNsaWtlIiwibmFtZSIsImxpbmsiLCJfaWQiLCJpc0xpa2VkIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZSIsIl9oYW5kbGVEaXNsaWtlIiwiZ2V0SWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xpa2VCdXR0b24iLCJjb250YWlucyIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlIiwidXBkYXRlTGlrZUJ1dHRvbiIsInRvZ2dsZSIsImdldFZpZXciLCJfZWxlbWVudCIsIl9jYXJkVGl0bGUiLCJzZXRBdHRyaWJ1dGUiLCJzcmMiLCJhbHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImtleSIsImNsb3NlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uQ29udGVudCIsImdldEZvcm0iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwic2V0TG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXRGb3JtIiwicmVzZXQiLCJlZGl0UHJvZmlsZVBvcHVwIiwiYXBpIiwidXBkYXRlVXNlclByb2ZpbGUiLCJ1c2VyTmFtZSIsInVzZXJEZXNjcmlwdGlvbiIsInRoZW4iLCJ1cGRhdGVkRGF0YSIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJhYm91dCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiZmluYWxseSIsInVwZGF0ZUF2YXRhclBvcHVwIiwiYXZhdGFyTGluayIsInVwZGF0ZVVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkUG9wdXAiLCJjYXJkRGF0YSIsImFkZE5ld0NhcmQiLCJuZXdDYXJkRGF0YSIsIm5ld0NhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsImNhcmRMaXN0IiwiYWRkSXRlbSIsInByZXZpZXdJbWFnZVBvcHVwIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJkZWxldGVDYXJkUG9wdXAiLCJoYW5kbGVDb25maXJtIiwiX2hhbmRsZUNvbmZpcm0iLCJfY29uZmlybUJ1dHRvbiIsIl9jbG9zZUJ1dHRvbiIsImNhcmQiLCJDYXJkIiwiY2FyZElkIiwiZGVsZXRlQ2FyZCIsImxpa2VDYXJkIiwidXBkYXRlZENhcmREYXRhIiwiZGlzbGlrZUNhcmQiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX2hhbmRsZUVycm9yIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJnZXRVc2VySW5mbyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiX3JlZjIiLCJsb2FkVXNlckluZm9BbmRDYXJkcyIsImFsbCIsImF1dGhvcml6YXRpb24iLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckRlc2NyaXB0aW9uU2VsZWN0b3IiLCJ1c2VyQXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWVFbGVtZW50IiwiX3VzZXJEZXNjcmlwdGlvbkVsZW1lbnQiLCJfdXNlckF2YXRhckVsZW1lbnQiLCJvbmxvYWQiLCJ1c2VyRGF0YSIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwicHJlcGVuZCIsImFwcGVuZCIsInJlbmRlckl0ZW1zIiwiY2FyZEVsZW1lbnQiLCJjYXJkcyIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJlZGl0QXZhdGFyRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=